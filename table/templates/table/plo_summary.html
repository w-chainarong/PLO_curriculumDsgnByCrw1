<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>üìò ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡πÅ‡∏•‡∏∞ CLOs ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞ PLO</title>
    <style>
        body { font-family: sans-serif; line-height: 1.6; margin: 20px; }
        table { border-collapse: collapse; width: 100%; margin-bottom: 30px; }
        th, td { border: 1px solid #444; padding: 8px; text-align: left; vertical-align: top; }
        th { background-color: #e0e0f8; }
        h2 { margin-top: 2rem; color: darkblue; }
        .no-clo { color: gray; }
        ul { margin: 0; padding-left: 1.2em; }
        .ksec-label { font-weight: bold; margin-top: 6px; display: inline-block; color: #333; }

        /* ‚úÖ ‡∏™‡∏µ‡∏ü‡πâ‡∏≤ */
        .text-blue { color: blue; font-weight: bold; }
    </style>
</head>
<body>

<h1>üìò ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡πÅ‡∏•‡∏∞ CLOs ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞ PLO</h1>
<h3>‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£: {{ curriculum.name }}</h3>

{% for plo_tag, item in summary.items %}
    <h2>{{ item.description }}</h2>
    <p><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤:</strong> {{ item.course_count }} ‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤ |
       <strong>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Å‡∏¥‡∏ï‡∏£‡∏ß‡∏°:</strong> {{ item.total_credits }} ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Å‡∏¥‡∏ï</p>

    <table>
        <thead>
            <tr>
                <th style="width: 120px; white-space: nowrap;">‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏¥‡∏ä‡∏≤</th>
                <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤</th>
                <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ CLO</th>
                <th>K/S/E/C (‡∏£‡∏´‡∏±‡∏™ + ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î)</th>
            </tr>
        </thead>
        <tbody>
            {% if item.courses %}
                {% for course in item.courses %}
                    <tr>
                        <td>{{ course.course_code }}</td>
                        <td>{{ course.course_name|safe }}</td>
                        <td>
                            {% if course.clos %}
                                <ul>
                                    {% for clo in course.clos %}
                                        <li>{{ clo|safe }}</li>
                                    {% endfor %}
                                </ul>
                            {% else %}
                                <span class="no-clo">‚Äì</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if course.ksec_grouped %}
                                {% for category, items in course.ksec_grouped.items %}
                                    {% if items %}
                                        <div class="ksec-label">
                                            {{ category }}:
                                            {% if course.clo_summary %}
                                                {% if category == "K" %}
                                                    <span class="text-blue">[{{ course.clo_summary.k_percent|floatformat:1 }}%]</span>
                                                {% endif %}
                                                {% if category == "S" %}
                                                    <span class="text-blue">[{{ course.clo_summary.s_percent|floatformat:1 }}%]</span>
                                                {% endif %}
                                                {% if category == "E" %}
                                                    <span class="text-blue">[{{ course.clo_summary.e_percent|floatformat:1 }}%]</span>
                                                {% endif %}
                                                {% if category == "C" %}
                                                    <span class="text-blue">[{{ course.clo_summary.c_percent|floatformat:1 }}%]</span>
                                                {% endif %}
                                            {% endif %}
                                        </div>
                                        <ul>
                                            {% for desc in items %}
                                                <li>{{ desc }}</li>
                                            {% endfor %}
                                        </ul>
                                    {% endif %}
                                {% endfor %}
                            {% else %}
                                <span class="no-clo">‚Äì</span>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="4" class="no-clo">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡πÇ‡∏¢‡∏á‡∏Å‡∏±‡∏ö {{ plo_tag }}</td>
                </tr>
            {% endif %}
        </tbody>
    </table>
{% endfor %}

</body>
</html>
